<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../css/backStage.css">
    <link rel="stylesheet" href="../../css/font.css">
    <link rel="stylesheet" href="../../css/project.css">
    <script src="../../js/date.format.js"></script>
    <script src="../../js/common.js"></script>
    <script src="../../js/hash.js"></script>
    <script src="../../js/backStage.js"></script>
    <script src="../../js/obj_wcj.js"></script>
    <script src="../../js/ajax.js"></script>
    <title>Document</title>
</head>
<body>
    <div class="full_cover">
        <div class="top_part">
            <div>
                <span>创</span>
                <span>益</span>
            </div>
            <div class="right_box">
                <span class="go_out">退出</span>
                <img src="../../images/tuichu.png" alt="">
            </div>
        </div>
        <div class="low_part">
            <div class="low_left">
                <div class="avator_area">
                    <div class="center_middle">
                        <div class="avator_circle">

                        </div>
                        <div class="username">叶苏幻</div>
                        <div class="sign">管理员</div>
                    </div>
                </div>
                <div class="hash_click">
                    <ul>
                        <li class="cur_li_d">
                            <div class="small_cir"></div>
                            <a href="#/project_d">志愿项目</a>
                        </li>
                        <li>
                            <div class="small_cir"></div>
                            <a href="#/team_d">志愿队伍</a>
                            <span class="blue_cir">5</span>
                        </li>
                        <li>
                            <div class="small_cir"></div>
                            <a href="#/show_d">风采展示</a>
                            <span class="blue_cir">5</span>
                        </li>
                        <li>
                            <div class="small_cir"></div>
                            <a href="#/adopt_d">领养动物</a>
                            <span class="blue_cir">5</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="low_right">
                <div class="page_1">
                    <div class="first_table">
                        
                    </div>
                    <div class="table_page"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
        let page_d=document.querySelectorAll('.page_1')[0];
        let page_table=document.querySelectorAll('.first_table')[0];
        let blue_cir=document.querySelectorAll('.blue_cir');
        let table_page=document.querySelectorAll('.table_page')[0];

        let str_p=`    <h2>审核列表</h2>
                        <table class="title_low"  cellpadding="0" cellspacing="0">
                            <tr>
                                <td>项目编号</td>
                                <td>项目名</td>
                                <td>创建人</td>
                                <td>申请时间</td>
                                <td>操作</td>
                            </tr>
                            <!-- 渲染区域,用字符串的拼接 -->
                            <tr class="render_tr">
                                <td>569834869</td>
                                <td>爱护花草树木</td>
                                <td>哈哈哈好好笑</td>
                                <td>2021年11月45日</td>
                                <td>
                                    <div>
                                        <div class="look_into pro_btn">
                                            <img src="../../images/look.png" alt="" class="pro_btn">
                                            <span class="look_span pro_btn">查看</span>
                                        </div>
                                        <img src="../../images/pass.png" alt="">
                                        <span class="pass_span">通过</span>
                                        <img src="../../images/not_pass.png" alt="">
                                        <span class="not_pass">不通过</span>
                                    </div>
                                </td>
                            </tr>
                        </table>`

        let str_t=`  <h2>审核列表</h2>
                        <table class="title_low"  cellpadding="0" cellspacing="0">
                            <tr>
                                <td>队伍编号</td>
                                <td>队伍名</td>
                                <td>创建人</td>
                                <td>申请时间</td>
                                <td>操作</td>
                            </tr>
                            <tr class="render_tr">
                                <td>3475878</td>
                                <td>创益当风时</td>
                                <td>DDJ</td>
                                <td>2021年10月1日</td>
                                <td>
                                    <div>
                                        <div class="look_into team_btn">
                                            <img src="../../images/look.png" alt="" class="team_btn">
                                            <span class="look_span team_btn">查看</span>
                                        </div>
                                        <img src="../../images/pass.png" alt="">
                                        <span class="pass_span">通过</span>
                                        <img src="../../images/not_pass.png" alt="">
                                        <span class="not_pass">不通过</span>
                                    </div>
                                </td>
                            </tr>
                        </table>`;

        let str_s=`   <h2>审核列表</h2>
                        <table class="title_low"  cellpadding="0" cellspacing="0">
                            <tr>
                                <td>项目/队伍编号</td>
                                <td>项目/队伍名</td>
                                <td>申请时间</td>
                                <td>操作</td>
                            </tr>
                            <!-- 渲染区域,用字符串的拼接 -->
                            <tr class="render_tr">
                                <td>3475878</td>
                                <td>创益当风时</td>
                                <td>2021年10月1日</td>
                                <td>
                                    <div>
                                        <div class="look_into show_btn">
                                            <img src="../../images/look.png" alt="" class="show_btn">
                                            <span class="look_span show_btn">查看</span>
                                        </div>
                                        <img src="../../images/pass.png" alt="">
                                        <span class="pass_span">通过</span>
                                        <img src="../../images/not_pass.png" alt="">
                                        <span class="not_pass">不通过</span>
                                    </div>
                                </td>
                            </tr>
                        </table>`;

        let str_a=`  <h2>审核列表</h2>
                         <table class="title_low"  cellpadding="0" cellspacing="0">
                             <tr>
                                 <td>动物编号</td>
                                 <td>领养人</td>
                                 <td>申请时间</td>
                                 <td>操作</td>
                             </tr>
                             <tr class="render_tr">
                                 <td>3475878</td>
                                 <td>陈钟华</td>
                                 <td>2021年10月1日</td>
                                 <td>
                                    <div>
                                        <div class="look_into adopt_btn">
                                            <img src="../../images/look.png" alt="" class="adopt_btn">
                                            <span class="look_span adopt_btn">查看</span>
                                        </div>
                                        <img src="../../images/pass.png" alt="">
                                        <span class="pass_span">通过</span>
                                        <img src="../../images/not_pass.png" alt="">
                                        <span class="not_pass">不通过</span>
                                    </div>
                                 </td>
                             </tr>
                         </table>`;
      
        let str_pInner=` <div class="pro_inner">
                            <button class="pro_back">&lt;返回</button>
                            <div>
                                <img src="../../images/beijing.jpg" alt="">
                                <ul>
                                    <li>
                                        <span class="list_circle"></span>
                                        项目名称：<span>爱护花草树木</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        创建人：<span>哈哈哈哈谢谢</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        项目人数：<span>50人</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        项目主题：<span>环保</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        项目进行地区：<span>广东省广州市</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        项目预计时长：<span>5天</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        <p>
                                            项目简介：哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈
                                        </p>
                                    </li>
                                </ul>
                            </div>
                        </div>`;
        
        let str_tInner=` <div class="team_inner">
                            <button class="team_back">&lt;返回</button>
                            <div>
                                <img src="../../images/beijing.jpg" alt="">
                                <ul>
                                    <li>
                                        <span class="list_circle"></span>
                                        队伍名称：<span>创益当风时</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        创建人：<span>DDJ</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        队伍人数：<span>5人</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        队伍所在地：<span>广东省广州市</span>
                                    </li>
                                    <li>
                                        <span class="list_circle"></span>
                                        <p>
                                            队伍简介：哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈
                                        </p>
                                    </li>
                                </ul>
                            </div>
                        </div>`;

        let str_sInner=` <div class="show_inner">
                            <button class="show_back">&lt;返回</button>
                            <div class="up_main">
                                <img src="../../images/beijing.jpg" alt="">
                            </div>
                            <div class="down_main">
                                <div class="down_center">
                                    <span>成就内容</span>
                                    <div class="p_box">
                                        <p>	自主开发志愿服务公益品牌——“快乐雷锋工程”系列项目13个，包括“爱老行动”、“助学行动”、“助行梦想”、“助美家园”、“雷锋饺子计划”、
                                            “寒家英才计划”、“公益流动专柜”、“义工月饼”、“雷锋学堂”、“雷锋老饭桌”、“水计划”、“城乡儿童互助体验”、
                                            “七彩阳光公益课堂”等常态化公益项目。
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        `;

        let str_aInner=` <div class="adopt_inner">
                            <button class="adopt_back">&lt;返回</button>
                            <ul>
                                <li>
                                    <img src="../../images/biaoqian (1).png" alt="" class="tag_img">
                                    <span>领养人信息</span>
                                </li>
                                <li>
                                    <span class="list_circle adopt_circle"></span>
                                    姓名：<span>陈换华</span>
                                </li>
                                <li>
                                    <span class="list_circle adopt_circle"></span>
                                   电话号码：<span>13329987665</span>
                                </li>
                                <li>
                                    <span class="list_circle adopt_circle"></span>
                                    身份证号码：<span>440436522698563245</span>
                                </li>
                                <li>
                                    <span class="list_circle adopt_circle"></span>
                                    地址：<span>广东省广州市天河区广东金融学院</span>
                                </li>
                                <li>
                                    <span class="list_circle adopt_circle"></span>
                                    职业：<span>学生</span>
                                </li>
                            </ul>
                        </div>`;

        function renderDoms(data){
            page_table.innerHTML='';
            let h2=document.createElement('h2');
                h2.innerText='审核列表';
                page_table.appendChild(h2);
                let table=document.createElement('table');
                table.classList.add('title_low');
                let tr=document.createElement('tr');
                page_table.appendChild(table);
                table.appendChild(tr);
                for(let j=0;j<=4;j++){
                    let td=document.createElement('td');
                    switch(j){
                        case 0:td.innerText='项目编号';td.classList.add('spe');break;
                        case 1:td.innerText='项目名';break;
                        case 2:td.innerText='创建人';break;
                        case 3:td.innerText='申请时间';break;
                        case 4:td.innerText='操作';
                    }
                    tr.appendChild(td);
                }
            for(let i=0;i<data.data.list.length;i++){
                var trs=document.createElement('tr');
                trs.classList.add('render_tr');
                var str_pp=`   
                                <td>${data.data.list[i].itemId}</td>
                                <td>
                                    <span class="flow_span"> ${data.data.list[i].itemTitle}</span>
                                </td>
                                <td>${data.data.list[i].username}</td>
                                <td>${new Date(data.data.list[i].gmtCreate).Format('yyyy年MM月dd日')}</td>
                                <td>
                                    <div>
                                        <div class="look_into pro_btn">
                                            <img src="../../images/look.png" alt="" class="pro_btn">
                                            <span class="look_span pro_btn">查看</span>
                                        </div>
                                        <div class="pass_d pass_this" id=${data.data.list[i].itemId}>
                                            <img src="../../images/pass.png" alt="" class="pass_this">
                                            <span class="pass_span pass_this">通过</span>
                                        </div>
                                        <div class="not_pass_a not_pass" id=${data.data.list[i].itemId}>
                                            <img src="../../images/not_pass.png" alt="" class="not_pass">
                                            <span class="not_pass">不通过</span>
                                        </div>
                                    </div>
                                </td>
                            `
                            trs.innerHTML=str_pp;
            table.appendChild(trs);
            }
            // console.log(page_table.innerHTML);
           
        }


        function renderAll(box,str){
            box.innerHTML=str;
        }

        window.addEventListener('load',()=>{
            
            // renderDoms(obj_manager);
            // render(obj_manager);

            ajax({
                        type:'get',
                        url:'/admin/item',
                        header:{
                            'Content-Type':'application/x-www-form-urlencoded'
                        },
                        data:{
                            pageSize:5,
                            pageNum:1
                        },
                        success:function(data){
                           renderDoms(data);
                           render(data);
                        },
                        error:function(){

                        }
                })

            var  turnpage_m;
            function render(data) {
                if (!turnpage_m) {
                    allpage = data.data.pages;
                    turnpage_m = new TurnPage({
                        currentPage: data.data.pageNum,
                        allPage: data.data.pages,
                        wrap:table_page,
                        changePage: function (page) {
                            ajax({
                                    type:'get',
                                    url:'/admin/item',
                                    header:{
                                        'Content-Type':'application/x-www-form-urlencoded'
                                    },
                                    data:{
                                        pageSize:5,
                                        pageNum:page
                                    },
                                    success:function(data){
                                        renderDoms(data);
                                    },
                                    error:function(){

                                    }
                                })
                        }
                    });
                }
                else if (allpage != data.data.pages) {
                    allpage = data.data.pages;
                    turnpage_m = new TurnPage({
                        currentPage: data.data.pageNum,
                        allPage: data.data.pages,
                        wrap:table_page,
                        changePage: function (page) {
                            ajax({
                                    type:'get',
                                    url:'/admin/item',
                                    header:{
                                        'Content-Type':'application/x-www-form-urlencoded'
                                    },
                                    data:{
                                        pageSize:5,
                                        pageNum:page
                                    },
                                    success:function(data){
                                        renderDoms(data);
                                    },
                                    error:function(){

                                    }
                                })
                        }
                    });
                }
                turnpage_m.init();
            }
        })


        window.addEventListener('hashchange',(e)=>{
            let hash=location.hash.slice(1);
            switch(hash){
                // case '':
                //     renderAll(page_table,str_p);
                //     return;

                case '/project_d':
                    ajax({
                        type:'get',
                        url:'/admin/item',
                        header:{
                            'Content-Type':'application/x-www-form-urlencoded'
                        },
                        data:{
                            pageSize:5,
                            pageNum:1
                        },
                        success:function(data){
                           renderDoms(data);
                        // 这里需不需要再调用一次呢    
                           render(data);
                        },
                        error:function(){

                        }
                    })
                    // renderDoms(obj_manager);
                    return;

                case '/team_d':
                    renderAll(page_table,str_t);
                    hide(blue_cir[0]);
                    hide(table_page);
                    return;

                case '/show_d':
                    renderAll(page_table,str_s);
                    hide(table_page);
                    hide(blue_cir[1]);
                    return;

                case '/adopt_d':
                    renderAll(page_table,str_a);
                    hide(table_page);
                    hide(blue_cir[2]);
            }
        })

        // 事件委托
        page_table.addEventListener('click',(e)=>{
            if(e.target.classList.contains('pro_btn')){
                page_table.innerHTML=str_pInner;
                hide(table_page);
            }
            if(e.target.classList.contains('pro_back')){
                ajax({
                        type:'get',
                        url:'/admin/item',
                        header:{
                            'Content-Type':'application/x-www-form-urlencoded'
                        },
                        data:{
                            pageSize:5,
                            pageNum:1
                        },
                        success:function(data){
                           renderDoms(data);
                        },
                        error:function(){

                        }
                    })
            }
            if(e.target.classList.contains('team_btn')){
                page_table.innerHTML=str_tInner;
            }
            if(e.target.classList.contains('team_back')){
                page_table.innerHTML=str_t;
            }
            if(e.target.classList.contains('show_back')){
                page_table.innerHTML=str_s;
            }
            if(e.target.classList.contains('show_btn')){
                page_table.innerHTML=str_sInner;
            }
            if(e.target.classList.contains('adopt_btn')){
                page_table.innerHTML=str_aInner;
            }
            if(e.target.classList.contains('adopt_back')){
                page_table.innerHTML=str_a;
            }
            if(e.target.classList.contains('pass_this')&&e.target.parentNode.id){
                ajax({
                        type:'post',
                        url:'/admin/items/check',
                        header:{
                            'Content-Type':'application/x-www-form-urlencoded'
                        },
                        data:{
                           option:true,
                           itemId:e.target.parentNode.id
                        },
                        success:function(data){
                          
                        },
                        error:function(){

                        }
                    })
            }
            if(e.target.classList.contains('not_pass')&&e.target.parentNode.id){
                ajax({
                        type:'post',
                        url:'/admin/items/check',
                        header:{
                            'Content-Type':'application/x-www-form-urlencoded'
                        },
                        data:{
                           option:false,
                           itemId:e.target.parentNode.id
                        },
                        success:function(data){
                          
                        },
                        error:function(){

                        }
                    })
            }
        })

    </script>
    <!-- <script>
        let router=new HashRouter();
        let page_d=document.querySelectorAll('.page_1')[0];

        // 注册首页回调函数
        // router.registerIndex(()=>
        //     page_d.innerHTML='我是首页'
        // );

        // 注册其他试图回调函数
        router.register('/project_d',()=>
            page_d.innerHTML='既是首页也是project'   
        );

        router.register('/team_d',()=>
            page_d.innerHTML='我是队伍页面'
        );

        router.register('/show_d',()=>
            page_d.innerHTML='我是风采展示页面'
        );

        router.register('/adopt_d',()=>
            page_d.innerHTML='我是领养动物页面'
        );

        // 加载试图
        router.load();

        // 注册未找到对应hash值时的回调
        router.registerNotFound(()=>
            page_d.innerHTML='页面未找到'
        );

        router.registerError((e)=>
            page_d.innerHTML='页面异常，错误信息：<br>'+e.message
        );
        
       window.addEventListener('hashchange',function(e){
           console.log(e.newURL);
       })
        
    </script> -->
</body>
</html>